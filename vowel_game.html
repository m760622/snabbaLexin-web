<!DOCTYPE html>
<html lang="sv" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Svenska Vokaler - Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ©</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&family=Inter:wght@300;400;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-color: #f8fafc;
            --text-muted: #94a3b8;
            --success: #10b981;
            --error: #ef4444;
            --fire: #f59e0b;
            --gold: #fbbf24;
            --fever-glow: #d946ef;
            --boss-red: #dc2626;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            /* Mobile System: Prevent Pull-to-Refresh/Bounce */
            overscroll-behavior: none;
            touch-action: manipulation;
            transition: background-color 1s ease;
        }

        /* Ambient Background */
        .ambient-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            transition: all 1s ease;
        }

        .orb-1 {
            width: 300px;
            height: 300px;
            top: -50px;
            left: -50px;
            background: #6366f1;
            animation: float 10s infinite alternate;
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            bottom: -100px;
            right: -100px;
            background: #a855f7;
            animation: float 12s infinite alternate-reverse;
        }

        @keyframes float {
            from {
                transform: translate(0, 0);
            }

            to {
                transform: translate(30px, 30px);
            }
        }

        /* BOSS MODE STYLING */
        body.boss-mode .ambient-bg .orb-1 {
            background: var(--boss-red);
            opacity: 0.6;
            animation-duration: 2s;
        }

        body.boss-mode .ambient-bg .orb-2 {
            background: #7f1d1d;
            opacity: 0.8;
            animation-duration: 3s;
        }

        body.boss-mode .level-badge {
            background: var(--boss-red);
            color: white;
            box-shadow: 0 0 15px var(--boss-red);
            animation: pulse-red 1s infinite;
        }

        @keyframes pulse-red {
            0% {
                box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(220, 38, 38, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(220, 38, 38, 0);
            }
        }

        /* Header */
        header {
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            height: 70px;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            padding: 12px;
            /* Larger touch target */
            display: flex;
            align-items: center;
            opacity: 0.8;
            transition: opacity 0.2s;
            min-width: 44px;
            /* Mobile Standard */
            min-height: 44px;
        }

        .back-btn:hover {
            opacity: 1;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
        }

        .stats-bar {
            display: flex;
            gap: 0.8rem;
            align-items: center;
        }

        .level-badge {
            background: rgba(99, 102, 241, 0.2);
            color: #818cf8;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.5s;
        }

        /* LIVES TANK */
        .lives-container {
            display: flex;
            gap: 4px;
            font-size: 1.2rem;
        }

        .heart {
            transition: transform 0.3s, opacity 0.3s, filter 0.3s;
        }

        .heart.lost {
            opacity: 0.2;
            transform: scale(0.8);
            filter: grayscale(100%);
        }

        .progress-container {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            width: 100%;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }

        body.boss-mode .progress-bar {
            background: var(--boss-red);
            box-shadow: 0 0 10px var(--boss-red);
        }

        /* Game Container */
        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
            perspective: 1200px;
            position: relative;
            /* Anchor for absolute countdown */
        }

        /* CARD ANIMATIONS */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .slide-in {
            animation: slideInUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .card-flipper {
            width: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            margin-bottom: 2rem;
        }

        .card-flipper.flipped {
            transform: rotateY(180deg);
        }

        .pair-card,
        .back-face {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 1.5rem;
            width: 100%;
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            backface-visibility: hidden;
            overflow: hidden;
            transition: box-shadow 0.3s, border-color 0.3s;
        }

        .pair-card::after,
        .back-face::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background: linear-gradient(115deg, transparent 40%, rgba(255, 255, 255, 0.05) 45%, transparent 50%);
            transform: translate(-100%, -100%);
            pointer-events: none;
            transition: transform 0.1s;
        }

        /* SKINS */
        body.skin-neon .pair-card {
            border: 2px solid var(--fever-glow);
            background: rgba(30, 41, 59, 0.95);
            box-shadow: 0 0 20px rgba(217, 70, 239, 0.2);
        }

        body.skin-gold .pair-card {
            border: 2px solid var(--gold);
            background: radial-gradient(circle at top right, #332d18, #1e293b);
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.3);
        }

        body.skin-gold .pair-card::after {
            background: linear-gradient(115deg, transparent 40%, rgba(251, 191, 36, 0.2) 45%, transparent 50%);
        }

        .back-face {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            transform: rotateY(180deg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .word-row {
            display: flex;
            justify-content: space-between;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
        }

        .word-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 1.2rem 0.5rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 18px;
            position: relative;
            transition: all 0.3s;
            cursor: default;
            opacity: 0.5;
            border: 2px solid transparent;
        }

        .word-item.active-target {
            opacity: 1;
            border-color: rgba(99, 102, 241, 0.5);
            border-style: dashed;
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-4px);
        }

        .word-item.solved {
            opacity: 1;
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
            border-style: solid;
        }

        .word-item.wrong {
            opacity: 1;
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.15);
            border-style: solid;
            color: var(--error);
        }

        body.boss-mode .word-item.active-target {
            border-color: var(--boss-red);
            background: rgba(220, 38, 38, 0.1);
        }

        body.boss-mode .missing-vowel {
            border-color: var(--boss-red);
            color: var(--boss-red);
        }

        .word-text {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0.5rem 0;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 3rem;
            pointer-events: none;
        }

        .word-emoji {
            font-size: 2rem;
            margin-bottom: 0.2rem;
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3));
        }

        .listen-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            margin-left: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            pointer-events: auto;
        }

        .missing-vowel {
            display: inline-block;
            width: 44px;
            height: 44px;
            line-height: 40px;
            border-bottom: 4px solid var(--primary);
            margin: 0 2px;
            text-align: center;
            color: var(--primary);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.2s;
        }

        .solved-text {
            animation: pop-in 0.4s;
            color: var(--success);
            display: inline-block;
        }

        @keyframes pop-in {
            from {
                transform: scale(0);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .back-face .context-sv {
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 0.2rem;
        }

        .back-face em {
            color: var(--primary);
            font-style: normal;
            text-decoration: underline;
        }

        /* Options */
        .options-area {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            width: 100%;
            padding: 0 1rem;
        }

        .vowel-btn {
            background: linear-gradient(145deg, #2a384f, #1e293b);
            border: none;
            color: var(--text-color);
            font-size: 2.2rem;
            font-weight: 800;
            padding: 1rem;
            border-radius: 20px;
            cursor: grab;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            top: 0;
            z-index: 2;
            touch-action: none;
            box-shadow: 0 6px 0 #0f172a, 0 10px 10px rgba(0, 0, 0, 0.3);
            /* Fix: Half width */
            max-width: 140px;
            margin: 0 auto;
            width: 100%;
        }

        .vowel-btn:active {
            top: 6px;
            box-shadow: 0 0 0 #0f172a;
            cursor: grabbing;
        }

        /* BOSS BANNER */
        .boss-banner {
            background: var(--boss-red);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            font-weight: 900;
            font-size: 1.5rem;
            text-align: center;
            width: 100%;
            margin-bottom: 1rem;
            animation: shake 2s infinite;
            display: none;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .speed-badge {
            position: absolute;
            top: 60px;
            /* Above stats bar roughly */
            left: 50%;
            transform: translateX(-50%) scale(0) rotate(10deg);
            /* Centered */
            background: #f59e0b;
            color: #fff;
            padding: 0.5rem 1.5rem;
            border-radius: 12px;
            font-weight: 900;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
            z-index: 100;
            pointer-events: none;
            transition: transform 0.3s;
        }

        .speed-badge.visible {
            transform: translateX(-50%) scale(1) rotate(10deg);
        }

        .flying-clone {
            position: fixed;
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            font-size: 2rem;
            font-weight: bold;
            pointer-events: none;
            z-index: 1000;
            transition: all 0.5s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .particle {
            position: absolute;
            pointer-events: none;
            animation: fade-fall 0.8s forwards;
            border-radius: 50%;
        }

        @keyframes fade-fall {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }

            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        .feedback-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(8px);
            text-align: center;
            border-radius: 20px;
        }

        .feedback-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .feedback-icon {
            font-size: 5rem;
            margin-bottom: 0.5rem;
            display: block;
            animation: pop-in 0.5s;
        }

        .feedback-text {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 1rem;
            color: #fff;
        }

        .end-screen {
            text-align: center;
            display: none;
            padding: 2rem;
            animation: pop-in 0.5s;
            z-index: 500;
            position: relative;
        }

        .inline-countdown {
            position: absolute;
            /* Fix: Float in the empty space */
            top: 20px;
            /* Adjust based on header height */
            left: 0;
            right: 0;
            text-align: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
        }

        .inline-countdown.visible {
            opacity: 1;
            /* height/margin removed to prevent shift */
        }

        .countdown-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary-light);
        }

        .countdown-text {
            font-size: 0.9rem;
            opacity: 0.8;
            color: var(--text-color);
        }

        .restart-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 1rem 3rem;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 1rem;
        }

        /* START SCREEN */
        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: opacity 0.5s;
        }

        .start-title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 2rem;
            text-align: center;
        }

        .start-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 1.2rem 4rem;
            border-radius: 50px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(99, 102, 241, 0.6);
        }

        .start-btn:active {
            transform: translateY(1px);
        }

        /* COMBO POPUP */
        .combo-text {
            position: absolute;
            font-size: 3rem;
            font-weight: 900;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
            pointer-events: none;
            z-index: 100;
            animation: combo-float 1s forwards;
        }

        @keyframes combo-float {
            0% {
                transform: scale(0) translateY(0) rotate(-10deg);
                opacity: 0;
            }

            50% {
                opacity: 1;
                transform: scale(1.2) translateY(-50px) rotate(0deg);
            }

            100% {
                opacity: 0;
                transform: scale(1.5) translateY(-100px) rotate(10deg);
            }
        }

        .shake {
            animation: shake-anim 0.4s cubic-bezier(.36, .07, .19, .97) both;
        }

        @keyframes shake-anim {

            10%,
            90% {
                transform: translate3d(-2px, 0, 0);
            }

            20%,
            80% {
                transform: translate3d(4px, 0, 0);
            }

            30%,
            50%,
            70% {
                transform: translate3d(-6px, 0, 0);
            }

            40%,
            60% {
                transform: translate3d(6px, 0, 0);
            }

            100% {
                transform: translate3d(0, 0, 0);
            }
        }

        /* Mobile Optimization */
        @media (max-width: 600px) {
            body {
                height: 100vh;
                overflow: hidden;
            }

            .game-container {
                justify-content: center;
                /* Move to middle as requested */
                padding: 10px;
                height: 100%;
                overflow-y: auto;
                position: relative;
            }

            header {
                height: 50px;
                padding: 0.5rem;
            }

            .start-title {
                font-size: 1.5rem;
            }

            .pair-card {
                padding: 1rem;
                margin-top: 2rem;
                /* Adjusted for center alignment */
                /* More space for countdown */
            }

            .word-row {
                gap: 0.5rem;
                margin-bottom: 0.5rem;
            }

            .word-item {
                padding: 0.5rem;
            }

            .word-emoji {
                font-size: 1.5rem;
                margin-bottom: 0;
            }

            .word-text {
                font-size: 1.4rem;
                margin: 0.2rem 0;
                min-height: 2rem;
            }

            .word-def {
                font-size: 1.3rem;
                /* Bigger Arabic font */
                line-height: 1.4;
                margin-top: 0.5rem;
                font-weight: 500;
            }

            .card-flipper {
                margin-bottom: 0.5rem;
            }

            .options-area {
                gap: 0.5rem;
                margin-top: auto;
                padding-bottom: 1rem;
            }

            .vowel-btn {
                padding: 0.8rem;
                font-size: 1.5rem;
                border-radius: 12px;
            }

            /* Enhanced Countdown */
            .inline-countdown {
                top: 15%;
                /* Visual center of top half */
                width: 100%;
                height: auto;
                justify-content: center;
                z-index: 50;
            }

            .countdown-number {
                font-size: 6rem;
                /* Massive */
                line-height: 1;
                filter: drop-shadow(0 0 20px rgba(99, 102, 241, 0.6));
                animation: pulse-countdown 1s infinite;
            }

            .countdown-text {
                font-size: 1.2rem;
                margin-top: 0;
                font-weight: bold;
                letter-spacing: 2px;
            }
        }

        @keyframes pulse-countdown {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Stage Map Overlay */
        .stage-map-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            z-index: 200;
            display: none;
            overflow-y: auto;
            padding: 2rem 1rem;
            backdrop-filter: blur(10px);
        }

        .stage-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .stage-node {
            aspect-ratio: 1;
            background: #334155;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #94a3b8;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .stage-node.solved {
            background: #10b981;
            color: #fff;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.4);
        }

        .stage-node.current {
            background: #3b82f6;
            color: #fff;
            animation: pulse-node 1.5s infinite;
            border: 2px solid #fff;
        }

        .stage-node.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @keyframes pulse-node {
            0% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
            }
        }

        /* Celebration Overlay */
        .celebration-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 150;
            display: none;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f00;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Daily Challenge */
        .daily-btn {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            border: none;
            padding: 1rem 2rem;
            border-radius: 16px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 1rem;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .daily-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.5);
        }

        .daily-btn.completed {
            background: linear-gradient(135deg, #10b981, #059669);
            pointer-events: none;
        }

        .daily-timer {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            color: #f59e0b;
            font-weight: bold;
            font-size: 1.2rem;
            z-index: 100;
            display: none;
        }

        .daily-badge {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            padding: 2rem 3rem;
            border-radius: 20px;
            color: #1e293b;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            z-index: 300;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .daily-badge.visible {
            transform: translate(-50%, -50%) scale(1);
        }

        /* Particle Effects */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
            font-size: 1.5rem;
            animation: particle-fly 1s ease-out forwards;
        }

        .particle.star {
            color: #fbbf24;
            text-shadow: 0 0 10px #fbbf24;
        }

        .particle.flame {
            color: #ef4444;
            text-shadow: 0 0 15px #ef4444, 0 0 30px #f97316;
        }

        .particle.sparkle {
            color: #a855f7;
            text-shadow: 0 0 10px #a855f7;
        }

        @keyframes particle-fly {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1) rotate(0deg);
            }

            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0.3) rotate(360deg);
            }
        }

        .burst-container {
            position: fixed;
            pointer-events: none;
            z-index: 999;
        }

        /* Audio Mode */
        .audio-btn {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border: none;
            padding: 1rem 2rem;
            border-radius: 16px;
            color: #fff;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 0.5rem;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .audio-btn:hover {
            transform: scale(1.05);
        }

        .audio-mode .word-text {
            filter: blur(12px);
            user-select: none;
            transition: filter 0.3s;
        }

        .audio-mode .word-text.revealed {
            filter: blur(0);
        }

        .audio-mode .word-emoji {
            font-size: 3rem;
        }

        .audio-hint {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 1rem;
            display: none;
            animation: pulse 1.5s infinite;
        }

        .audio-mode .audio-hint {
            display: block;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }
    </style>
</head>

<body>

    <div class="ambient-bg">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
    </div>

    <!-- START SCREEN -->
    <div id="startScreen" class="start-screen">
        <div class="orb orb-1" style="width:200px; height:200px;"></div>
        <h1 class="start-title">Svenska Vokaler<br><span style="font-size:1.5rem; font-weight:400; opacity:0.8;">ØªØ­Ø¯ÙŠ
                Ø§Ù„Ø£ØµÙˆØ§Øª Ø§Ù„Ø³ÙˆÙŠØ¯ÙŠØ©</span></h1>
        <button class="start-btn" onclick="startGame()">BÃ¶rja Spela â–¶</button>
        <button class="daily-btn" id="dailyBtn" onclick="startDailyChallenge()">ğŸŒŸ Dagens Utmaning</button>
        <button class="audio-btn" onclick="startAudioMode()">ğŸ”Š LjudlÃ¤ge</button>
        <p style="margin-top:2rem; opacity:0.5; font-size:0.9rem;">Turn on sound ğŸ”Š</p>
    </div>

    <div class="progress-container">
        <div id="progressBar" class="progress-bar"></div>
    </div>

    <header>
        <button class="back-btn" onclick="window.history.back()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        </button>

        <div class="stats-bar">
            <div class="lives-container" id="livesContainer">
                <span class="heart">â¤ï¸</span><span class="heart">â¤ï¸</span><span class="heart">â¤ï¸</span>
            </div>
            <div class="level-badge" id="levelBadge" onclick="toggleStageMap()" style="cursor: pointer;">Start!</div>
        </div>
    </header>

    <div class="game-container">
        <!-- Stage Map Modal -->
        <div id="stageMapOverlay" class="stage-map-overlay">
            <h2 style="text-align:center; color:#fff; margin-bottom:1rem;">KartlÃ¤ggning ğŸ—ºï¸</h2>
            <div id="stageGrid" class="stage-grid"></div>
            <button onclick="toggleStageMap()"
                style="display:block; margin:2rem auto; padding:1rem 2rem; background:#ef4444; border:none; border-radius:10px; color:#fff; font-weight:bold;">Close</button>
        </div>

        <!-- Celebration Container -->
        <div id="celebrationOverlay" class="celebration-overlay"></div>

        <!-- Daily Challenge UI -->
        <div class="daily-timer" id="dailyTimer">â±ï¸ 00:00</div>
        <div class="daily-badge" id="dailyBadge">
            ğŸ† Dagens Utmaning Avklarad!<br>
            <span style="font-size:2rem;">+3 â¤ï¸</span>
        </div>

        <div id="playArea" style="width: 100%; display:none;">

            <div id="bossBanner" class="boss-banner">âš ï¸ BOSS WAVE âš ï¸</div>

            <div id="inlineCountdown" class="inline-countdown"></div>

            <div class="speed-badge" id="speedBadge">SNABB! âš¡ï¸</div>

            <div class="audio-hint" id="audioHint">ğŸ”Š Klicka pÃ¥ hÃ¶gtalaren fÃ¶r att lyssna!</div>

            <div class="card-flipper slide-in" id="cardFlipper">
                <!-- FRONT -->
                <div id="questionCard" class="pair-card">
                    <div class="word-row">
                        <div id="slot1" class="word-item drop-zone" data-slot="1">
                            <div class="word-emoji" id="emoji1"></div>
                            <div class="word-top-row">
                                <div class="word-text word-1-text">B<span class="missing-vowel"></span>l</div>
                                <button class="listen-btn" onclick="playAudioForSlot(1)" aria-label="Lyssna">ğŸ”Š</button>
                            </div>
                            <div class="word-def word-1-def">ÙƒØ±Ø©</div>
                        </div>
                        <div id="slot2" class="word-item drop-zone" data-slot="2">
                            <div class="word-emoji" id="emoji2"></div>
                            <div class="word-top-row">
                                <div class="word-text word-2-text">B<span class="missing-vowel"></span>l</div>
                                <button class="listen-btn" onclick="playAudioForSlot(2)" aria-label="Lyssna">ğŸ”Š</button>
                            </div>
                            <div class="word-def word-2-def">Ø¬Ø°Ø¹ (Ø´Ø¬Ø±Ø©)</div>
                        </div>
                    </div>
                </div>

                <!-- BACK -->
                <div class="back-face" id="backFace">
                    <div class="context-title">Exempelmeningar</div>
                    <div class="context-row">
                        <span class="context-emoji" id="backEmoji1"></span>
                        <div class="context-sv" id="sentence1"></div>
                    </div>
                    <div class="context-row">
                        <span class="context-emoji" id="backEmoji2"></span>
                        <div class="context-sv" id="sentence2"></div>
                    </div>
                </div>
            </div>

            <!-- Feedback -->
            <div class="feedback-overlay" id="feedbackOverlay">
                <span class="feedback-icon" id="feedbackIcon">âœ…</span>
                <div class="feedback-text" id="feedbackText">Bra jobbat!</div>
            </div>

            <div class="options-area" id="optionsArea"></div>
        </div>

        <div id="endScreen" class="end-screen">
            <h1 id="endTitle">Grattis! ğŸ‘‘</h1>
            <p id="endMessage">Du klarade spelet!</p>
            <div class="end-score" id="finalScore"></div>
            <button class="restart-btn" onclick="location.reload()">Spela igen</button>
        </div>
    </div>

    <script>
        // ==========================================
        // DATA
        // ==========================================
        const minimalPairsData = [
            // === O vs Ã– (25 pairs) ===
            { pair: ["O", "Ã–"], w1: "Bol", d1: "Ø¹Ø´", w2: "BÃ¶l", d2: "Ø£Ù…ÙˆØ§Ø¬", frame: "B_l", e1: "ğŸ¢", e2: "ğŸŒŠ", s1: "Getingarna har ett bol.", s2: "Det fanns stora bÃ¶ljor." },
            { pair: ["O", "Ã–"], w1: "Bot", d1: "Ø¹Ù„Ø§Ø¬", w2: "BÃ¶t", d2: "Ø¨Ø§Ø¯Ù„", frame: "B_t", e1: "ğŸ’Š", e2: "ğŸ’¸", s1: "Det finns ingen bot.", s2: "Han bÃ¶t sin bil." },
            { pair: ["O", "Ã–"], w1: "Mossa", d1: "Ø·Ø­Ù„Ø¨", w2: "MÃ¶ssa", d2: "Ù‚Ø¨Ø¹Ø©", frame: "M_ssa", e1: "ğŸŒ¿", e2: "ğŸ§¢", s1: "Stenen var tÃ¤ckt av mossa.", s2: "Ta pÃ¥ dig en mÃ¶ssa!" },
            { pair: ["O", "Ã–"], w1: "Hov", d1: "Ø­Ø§ÙØ±", w2: "HÃ¶v", d2: "Ø²Ø¹ÙŠÙ…", frame: "H_v", e1: "ğŸ", e2: "ğŸ‘‘", s1: "HÃ¤sten har en skada i sin hov.", s2: "Vikingarna hade en hÃ¶vding." },
            { pair: ["O", "Ã–"], w1: "Son", d1: "Ø§Ø¨Ù†", w2: "SÃ¶n", d2: "Ø£Ø­Ø¯", frame: "S_n", e1: "ğŸ‘¦", e2: "ğŸ“…", s1: "Min son heter Erik.", s2: "Vi ses pÃ¥ sÃ¶n." },
            { pair: ["O", "Ã–"], w1: "Not", d1: "Ù†ÙˆØªØ©", w2: "NÃ¶t", d2: "Ø¬ÙˆØ²", frame: "N_t", e1: "ğŸµ", e2: "ğŸ¥œ", s1: "Kan du lÃ¤sa en not?", s2: "Ekorren hittade en nÃ¶t." },
            { pair: ["O", "Ã–"], w1: "Rom", d1: "Ø±ÙˆÙ…Ø§", w2: "RÃ¶m", d2: "Ù‡Ø±ÙˆØ¨", frame: "R_m", e1: "ğŸ›ï¸", e2: "ğŸƒ", s1: "Alla vÃ¤gar bÃ¤r till Rom.", s2: "FÃ¥ngen gjorde en rÃ¶mning." },
            { pair: ["O", "Ã–"], w1: "Ko", d1: "Ø¨Ù‚Ø±Ø©", w2: "KÃ¶", d2: "Ø·Ø§Ø¨ÙˆØ±", frame: "K_", e1: "ğŸ®", e2: "ğŸš¶", s1: "En ko sÃ¤ger mu.", s2: "Det var lÃ¥ng kÃ¶." },
            { pair: ["O", "Ã–"], w1: "Ros", d1: "ÙˆØ±Ø¯Ø©", w2: "RÃ¶s", d2: "ÙƒÙˆÙ… Ø­Ø¬Ø§Ø±Ø©", frame: "R_s", e1: "ğŸŒ¹", e2: "ğŸª¨", s1: "En rÃ¶d ros.", s2: "Ett gammalt rÃ¶s." },
            { pair: ["O", "Ã–"], w1: "Lod", d1: "Ø±ØµØ§Øµ", w2: "LÃ¶d", d2: "Ù„Ø­Ù…", frame: "L_d", e1: "âš–ï¸", e2: "ğŸ”§", s1: "Ett lod fÃ¶r fiske.", s2: "Han lÃ¶dde rÃ¶ret." },
            { pair: ["O", "Ã–"], w1: "Skog", d1: "ØºØ§Ø¨Ø©", w2: "SkÃ¶g", d2: "Ø¯ÙØ¹", frame: "Sk_g", e1: "ğŸŒ²", e2: "ğŸ‘", s1: "Vi gick i skogen.", s2: "Han skÃ¶t upp det." },
            { pair: ["O", "Ã–"], w1: "Doft", d1: "Ø±Ø§Ø¦Ø­Ø©", w2: "DÃ¶ft", d2: "Ø®Ø§ÙØª", frame: "D_ft", e1: "ğŸ‘ƒ", e2: "ğŸ’¡", s1: "En hÃ¤rlig doft.", s2: "Ett dÃ¶ft ljus." },
            { pair: ["O", "Ã–"], w1: "Fort", d1: "Ø³Ø±ÙŠØ¹", w2: "FÃ¶rt", d2: "Ø£Ø­Ø¶Ø±", frame: "F_rt", e1: "âš¡", e2: "ğŸ“¦", s1: "GÃ¥ fort!", s2: "Jag har fÃ¶rt paketet." },
            { pair: ["O", "Ã–"], w1: "Ort", d1: "Ù…ÙƒØ§Ù†", w2: "Ã–rt", d2: "Ø¹Ø´Ø¨", frame: "_rt", e1: "ğŸ“", e2: "ğŸŒ¿", s1: "En liten ort.", s2: "En medicinsk Ã¶rt." },
            { pair: ["O", "Ã–"], w1: "Sot", d1: "Ø³Ø®Ø§Ù…", w2: "SÃ¶t", d2: "Ø­Ù„Ùˆ", frame: "S_t", e1: "âš«", e2: "ğŸ¬", s1: "Sot frÃ¥n elden.", s2: "En sÃ¶t kaka." },
            { pair: ["O", "Ã–"], w1: "Torn", d1: "Ø¨Ø±Ø¬", w2: "TÃ¶rn", d2: "Ø´ÙˆÙƒØ©", frame: "T_rn", e1: "ğŸ—¼", e2: "ğŸŒµ", s1: "Ett hÃ¶gt torn.", s2: "En tÃ¶rne i foten." },
            { pair: ["O", "Ã–"], w1: "Stora", d1: "ÙƒØ¨Ø§Ø±", w2: "StÃ¶ra", d2: "ÙŠØ²Ø¹Ø¬", frame: "St_ra", e1: "ğŸ“", e2: "ğŸ””", s1: "Stora barn.", s2: "StÃ¶r mig inte!" },
            { pair: ["O", "Ã–"], w1: "Bord", d1: "Ø·Ø§ÙˆÙ„Ø©", w2: "BÃ¶rd", d2: "Ø£ØµÙ„", frame: "B_rd", e1: "ğŸª‘", e2: "ğŸ‘ª", s1: "Sitt vid bordet.", s2: "Av god bÃ¶rd." },
            { pair: ["O", "Ã–"], w1: "Kort", d1: "Ø¨Ø·Ø§Ù‚Ø©", w2: "KÃ¶rt", d2: "Ù‚Ø§Ø¯", frame: "K_rt", e1: "ğŸ’³", e2: "ğŸš—", s1: "Ett kreditkort.", s2: "Jag har kÃ¶rt bil." },
            { pair: ["O", "Ã–"], w1: "Lova", d1: "ÙŠØ¹Ø¯", w2: "LÃ¶va", d2: "Ø£ÙˆØ±Ø§Ù‚", frame: "L_va", e1: "ğŸ¤", e2: "ğŸƒ", s1: "Jag lovar dig.", s2: "TrÃ¤det lÃ¶var." },
            { pair: ["O", "Ã–"], w1: "Hora", d1: "Ø¹Ø§Ù‡Ø±Ø©", w2: "HÃ¶ra", d2: "ÙŠØ³Ù…Ø¹", frame: "H_ra", e1: "ğŸš«", e2: "ğŸ‘‚", s1: "Ett fult ord.", s2: "Kan du hÃ¶ra mig?" },
            { pair: ["O", "Ã–"], w1: "Kola", d1: "ÙƒØ±Ø§Ù…ÙŠÙ„", w2: "KÃ¶la", d2: "Ø¹Ø§Ø±Ø¶Ø©", frame: "K_la", e1: "ğŸ¬", e2: "â›µ", s1: "En sÃ¶t kola.", s2: "BÃ¥tens kÃ¶l." },
            { pair: ["O", "Ã–"], w1: "Boka", d1: "ÙŠØ­Ø¬Ø²", w2: "BÃ¶ka", d2: "ÙŠÙ†Ø¨Ø´", frame: "B_ka", e1: "ğŸ“…", e2: "ğŸ·", s1: "Boka ett bord.", s2: "Grisen bÃ¶kar." },
            { pair: ["O", "Ã–"], w1: "Stol", d1: "ÙƒØ±Ø³ÙŠ", w2: "StÃ¶l", d2: "Ø³Ø±Ù‚Ø©", frame: "St_l", e1: "ğŸª‘", e2: "ğŸ¦¹", s1: "Sitt pÃ¥ stolen.", s2: "En stÃ¶ld." },
            { pair: ["O", "Ã–"], w1: "Fog", d1: "Ù…ÙØµÙ„", w2: "FÃ¶g", d2: "Ø·Ø§Ø±", frame: "F_g", e1: "ğŸ¦´", e2: "ğŸ•Šï¸", s1: "En fog i vÃ¤ggen.", s2: "FÃ¥geln flÃ¶g." },

            // === U vs Y (25 pairs) ===
            { pair: ["U", "Y"], w1: "Sur", d1: "Ø­Ø§Ù…Ø¶", w2: "Syr", d2: "ÙŠØ®ÙŠØ·", frame: "S_r", e1: "ğŸ‹", e2: "ğŸ§µ", s1: "Citronen smakar surt.", s2: "Hon syr en klÃ¤nning." },
            { pair: ["U", "Y"], w1: "Bur", d1: "Ù‚ÙØµ", w2: "Byr", d2: "Ø®Ø²Ø§Ù†Ø©", frame: "B_r", e1: "ğŸ¦", e2: "ğŸ—„ï¸", s1: "FÃ¥geln sitter i en bur.", s2: "LÃ¤gg klÃ¤derna i byrÃ¥n." },
            { pair: ["U", "Y"], w1: "Ur", d1: "Ø³Ø§Ø¹Ø©", w2: "Yr", d2: "Ø¯ÙˆØ§Ø±", frame: "_r", e1: "ğŸ•°ï¸", e2: "ğŸ˜µ", s1: "TÃ¥get gick ur spÃ¥r.", s2: "Hon kÃ¤nde sig yr." },
            { pair: ["U", "Y"], w1: "Kus", d1: "Ø­Ø´Ø±Ø©", w2: "Kyss", d2: "Ù‚Ø¨Ù„Ø©", frame: "K_ss", e1: "ğŸ›", e2: "ğŸ’‹", s1: "En liten kus.", s2: "Han gav henne en kyss." },
            { pair: ["U", "Y"], w1: "Lukta", d1: "ÙŠØ´Ù…", w2: "Lykta", d2: "Ù…ØµØ¨Ø§Ø­", frame: "L_kta", e1: "ğŸ‘ƒ", e2: "ğŸ®", s1: "Blomman luktar gott.", s2: "TÃ¤nd din lykta." },
            { pair: ["U", "Y"], w1: "Ful", d1: "Ù‚Ø¨ÙŠØ­", w2: "Fyl", d2: "Ø³ÙƒÙŠØ±", frame: "F_l", e1: "ğŸ‘¹", e2: "ğŸ¥´", s1: "En ful tavla.", s2: "Ett fyllo pÃ¥ bÃ¤nken." },
            { pair: ["U", "Y"], w1: "Brun", d1: "Ø¨Ù†ÙŠ", w2: "Bryn", d2: "Ø­Ø§Ø¬Ø¨", frame: "Br_n", e1: "ğŸŸ¤", e2: "ğŸ‘ï¸", s1: "En brun hund.", s2: "Rynka pÃ¥ brynet." },
            { pair: ["U", "Y"], w1: "Mur", d1: "Ø¬Ø¯Ø§Ø±", w2: "Myr", d2: "Ù…Ø³ØªÙ†Ù‚Ø¹", frame: "M_r", e1: "ğŸ§±", e2: "ğŸŒ¾", s1: "En hÃ¶g mur.", s2: "En myr i skogen." },
            { pair: ["U", "Y"], w1: "Tur", d1: "Ø­Ø¸", w2: "Tyr", d2: "Ø«ÙˆØ±", frame: "T_r", e1: "ğŸ€", e2: "ğŸ‚", s1: "Vilken tur!", s2: "Guden Tyr." },
            { pair: ["U", "Y"], w1: "Sura", d1: "ÙŠØºØ¶Ø¨", w2: "Syra", d2: "Ø­Ù…Ø¶", frame: "S_ra", e1: "ğŸ˜¤", e2: "âš—ï¸", s1: "Han surar.", s2: "Syra i labbet." },
            { pair: ["U", "Y"], w1: "Ruta", d1: "Ù†Ø§ÙØ°Ø©", w2: "Ryta", d2: "ÙŠØ²Ø£Ø±", frame: "R_ta", e1: "ğŸªŸ", e2: "ğŸ¦", s1: "En fÃ¶nsterruta.", s2: "Lejonet ryter." },
            { pair: ["U", "Y"], w1: "Dun", d1: "Ø±ÙŠØ´", w2: "Dyn", d2: "ÙƒØ«ÙŠØ¨", frame: "D_n", e1: "ğŸª¶", e2: "ğŸœï¸", s1: "Mjukt dun.", s2: "En sanddyn." },
            { pair: ["U", "Y"], w1: "Kul", d1: "Ù…Ù…ØªØ¹", w2: "Kyl", d2: "Ø«Ù„Ø§Ø¬Ø©", frame: "K_l", e1: "ğŸ˜„", e2: "â„ï¸", s1: "Det var kul!", s2: "LÃ¤gg i kylen." },
            { pair: ["U", "Y"], w1: "Fur", d1: "ØµÙ†ÙˆØ¨Ø±", w2: "Fyr", d2: "Ù…Ù†Ø§Ø±Ø©", frame: "F_r", e1: "ğŸŒ²", e2: "ğŸ ", s1: "En fur i skogen.", s2: "En fyr vid havet." },
            { pair: ["U", "Y"], w1: "Nu", d1: "Ø§Ù„Ø¢Ù†", w2: "Ny", d2: "Ø¬Ø¯ÙŠØ¯", frame: "N_", e1: "â°", e2: "âœ¨", s1: "Kom nu!", s2: "En ny bil." },
            { pair: ["U", "Y"], w1: "Spun", d1: "ØºØ²Ù„", w2: "Spyn", d2: "ØªÙ‚ÙŠØ£", frame: "Sp_n", e1: "ğŸ§¶", e2: "ğŸ¤®", s1: "Hon spann garn.", s2: "Han spydde." },
            { pair: ["U", "Y"], w1: "Gul", d1: "Ø£ØµÙØ±", w2: "Gyl", d2: "Ø®ÙŠØ§Ø´ÙŠÙ…", frame: "G_l", e1: "ğŸ’›", e2: "ğŸŸ", s1: "En gul sol.", s2: "Fiskens gÃ¤lar." },
            { pair: ["U", "Y"], w1: "Hund", d1: "ÙƒÙ„Ø¨", w2: "Hynd", d2: "ÙƒÙ„Ø¨Ø©", frame: "H_nd", e1: "ğŸ•", e2: "ğŸ•â€ğŸ¦º", s1: "En snÃ¤ll hund.", s2: "En hynd med valpar." },
            { pair: ["U", "Y"], w1: "Kung", d1: "Ù…Ù„Ùƒ", w2: "Kyng", d2: "Ù…Ù„ØªÙ", frame: "K_ng", e1: "ğŸ‘‘", e2: "ğŸ”„", s1: "Kungen bor i slottet.", s2: "Ormen kynger." },
            { pair: ["U", "Y"], w1: "Sudd", d1: "Ù…Ù…Ø­Ø§Ø©", w2: "Sydd", d2: "Ù…Ø®ÙŠØ·", frame: "S_dd", e1: "âœï¸", e2: "ğŸ§µ", s1: "Ett sudd fÃ¶r att radera.", s2: "En sydd klÃ¤nning." },
            { pair: ["U", "Y"], w1: "Luft", d1: "Ù‡ÙˆØ§Ø¡", w2: "Lyft", d2: "Ø±ÙØ¹", frame: "L_ft", e1: "ğŸ’¨", e2: "ğŸ’ª", s1: "Frisk luft.", s2: "Lyft den tunga lÃ¥dan." },
            { pair: ["U", "Y"], w1: "Surra", d1: "ÙŠØ±Ø¨Ø·", w2: "Syrra", d2: "Ø£Ø®Øª", frame: "S_rra", e1: "ğŸ”—", e2: "ğŸ‘§", s1: "Surra fast lasten.", s2: "Min syrra Ã¤r snÃ¤ll." },
            { pair: ["U", "Y"], w1: "Fluga", d1: "Ø°Ø¨Ø§Ø¨Ø©", w2: "Flyga", d2: "ÙŠØ·ÙŠØ±", frame: "Fl_ga", e1: "ğŸª°", e2: "âœˆï¸", s1: "En irriterande fluga.", s2: "Jag vill flyga." },
            { pair: ["U", "Y"], w1: "Knuff", d1: "Ø¯ÙØ¹Ø©", w2: "Knyff", d2: "Ø­ÙŠÙ„Ø©", frame: "Kn_ff", e1: "ğŸ‘", e2: "ğŸ­", s1: "En lÃ¤tt knuff.", s2: "Ett smart knyff." },
            { pair: ["U", "Y"], w1: "Stuv", d1: "ÙŠØ®Ù†Ø©", w2: "Styv", d2: "ØµÙ„Ø¨", frame: "St_v", e1: "ğŸ²", e2: "ğŸ’ª", s1: "En god stuvning.", s2: "Styv i kroppen." },

            // === A vs Ã„ (25 pairs) ===
            { pair: ["A", "Ã„"], w1: "Tak", d1: "Ø³Ù‚Ù", w2: "TÃ¤ck", d2: "ØºØ·Ø§Ø¡", frame: "T_k", e1: "ğŸ ", e2: "ğŸ›¡ï¸", s1: "Husets tak.", s2: "TÃ¤ck Ã¶ver maten." },
            { pair: ["A", "Ã„"], w1: "Bar", d1: "Ø­Ø§Ù†Ø©", w2: "BÃ¤r", d2: "ØªÙˆØª", frame: "B_r", e1: "ğŸº", e2: "ğŸ“", s1: "Han gick till en bar.", s2: "Skogen Ã¤r full av bÃ¤r." },
            { pair: ["A", "Ã„"], w1: "Man", d1: "Ø±Ø¬Ù„", w2: "MÃ¤n", d2: "Ø±Ø¬Ø§Ù„", frame: "M_n", e1: "ğŸ‘¨", e2: "ğŸ‘¥", s1: "En man gick fÃ¶rbi.", s2: "TvÃ¥ mÃ¤n pratade." },
            { pair: ["A", "Ã„"], w1: "Mat", d1: "Ø·Ø¹Ø§Ù…", w2: "MÃ¤tt", d2: "Ø´Ø¨Ø¹Ø§Ù†", frame: "M_t", e1: "ğŸ½ï¸", e2: "ğŸ˜‹", s1: "God mat!", s2: "Jag Ã¤r mÃ¤tt." },
            { pair: ["A", "Ã„"], w1: "Van", d1: "Ù…Ø¹ØªØ§Ø¯", w2: "VÃ¤n", d2: "ØµØ¯ÙŠÙ‚", frame: "V_n", e1: "ğŸ”„", e2: "ğŸ¤", s1: "Jag Ã¤r van vid det.", s2: "Min bÃ¤sta vÃ¤n." },
            { pair: ["A", "Ã„"], w1: "Lag", d1: "ÙØ±ÙŠÙ‚", w2: "LÃ¤g", d2: "ÙˆØ¶Ø¹", frame: "L_g", e1: "âš½", e2: "ğŸ“", s1: "Ett bra lag.", s2: "LÃ¤get Ã¤r bra." },
            { pair: ["A", "Ã„"], w1: "Hal", d1: "Ø²Ù„Ù‚", w2: "HÃ¤l", d2: "ÙƒØ¹Ø¨", frame: "H_l", e1: "ğŸ§Š", e2: "ğŸ‘ ", s1: "Isen Ã¤r hal.", s2: "Ont i hÃ¤len." },
            { pair: ["A", "Ã„"], w1: "Dag", d1: "ÙŠÙˆÙ…", w2: "DÃ¤g", d2: "Ø¹Ø¬ÙŠÙ†", frame: "D_g", e1: "â˜€ï¸", e2: "ğŸ", s1: "En fin dag.", s2: "BrÃ¶ddeg." },
            { pair: ["A", "Ã„"], w1: "Kal", d1: "Ø£ØµÙ„Ø¹", w2: "KÃ¤l", d2: "Ù†Ø¨Ø¹", frame: "K_l", e1: "ğŸ‘¨â€ğŸ¦²", e2: "ğŸ’§", s1: "En kal man.", s2: "En kÃ¤lla i skogen." },
            { pair: ["A", "Ã„"], w1: "Tal", d1: "Ø®Ø·Ø§Ø¨", w2: "TÃ¤l", d2: "ÙŠØªØ­Ù…Ù„", frame: "T_l", e1: "ğŸ¤", e2: "ğŸ’ª", s1: "Ett viktigt tal.", s2: "Han tÃ¥l smÃ¤rta." },
            { pair: ["A", "Ã„"], w1: "Sal", d1: "Ù‚Ø§Ø¹Ø©", w2: "SÃ¤l", d2: "ÙÙ‚Ù…Ø©", frame: "S_l", e1: "ğŸ›ï¸", e2: "ğŸ¦­", s1: "En stor sal.", s2: "En sÃ¶t sÃ¤l." },
            { pair: ["A", "Ã„"], w1: "Gas", d1: "ØºØ§Ø²", w2: "GÃ¤s", d2: "Ø¥ÙˆØ²", frame: "G_s", e1: "â›½", e2: "ğŸ¦¢", s1: "Gas fÃ¶r matlagning.", s2: "GÃ¤ssen flyger." },
            { pair: ["A", "Ã„"], w1: "Rack", d1: "Ø­Ø§Ù…Ù„", w2: "RÃ¤ck", d2: "Ù†Ø§ÙˆÙ„", frame: "R_ck", e1: "ğŸ§¥", e2: "ğŸ¤²", s1: "Ett klÃ¤drack.", s2: "RÃ¤ck mig saltet." },
            { pair: ["A", "Ã„"], w1: "Sack", d1: "ÙƒÙŠØ³", w2: "SÃ¤ck", d2: "ÙƒÙŠØ³", frame: "S_ck", e1: "ğŸ‘", e2: "ğŸ’", s1: "En papperssÃ¤ck.", s2: "En mjÃ¶lsÃ¤ck." },
            { pair: ["A", "Ã„"], w1: "Pack", d1: "Ø­Ø²Ù…Ø©", w2: "PÃ¤ck", d2: "ØºÙ„Ø§Ù", frame: "P_ck", e1: "ğŸ“¦", e2: "ğŸ", s1: "Packa vÃ¤skan.", s2: "PÃ¤ckpapper." },
            { pair: ["A", "Ã„"], w1: "Rasa", d1: "ÙŠÙ†Ù‡Ø§Ø±", w2: "RÃ¤sa", d2: "ÙŠÙ‡Ø±Ø¹", frame: "R_sa", e1: "ğŸšï¸", e2: "ğŸƒ", s1: "Huset rasar.", s2: "Han rÃ¤sar ivÃ¤g." },
            { pair: ["A", "Ã„"], w1: "Stall", d1: "Ø¥Ø³Ø·Ø¨Ù„", w2: "StÃ¤ll", d2: "Ø±Ù", frame: "St_ll", e1: "ğŸ´", e2: "ğŸ—„ï¸", s1: "HÃ¤star i stallet.", s2: "Ett skostÃ¤ll." },
            { pair: ["A", "Ã„"], w1: "Gnata", d1: "ÙŠØªØ°Ù…Ø±", w2: "GnÃ¤ta", d2: "ÙŠØ¹Ø§ØªØ¨", frame: "Gn_ta", e1: "ğŸ˜¤", e2: "ğŸ˜ ", s1: "Sluta gnata!", s2: "Hon gnÃ¤ter." },
            { pair: ["A", "Ã„"], w1: "Fara", d1: "Ø®Ø·Ø±", w2: "FÃ¤ra", d2: "Ø±Ø­Ù„Ø©", frame: "F_ra", e1: "âš ï¸", e2: "ğŸš¢", s1: "En stor fara.", s2: "En lÃ¥ng fÃ¤rd." },
            { pair: ["A", "Ã„"], w1: "Valla", d1: "ÙŠØ±Ø¹Ù‰", w2: "VÃ¤lla", d2: "ÙŠÙÙŠØ¶", frame: "V_lla", e1: "ğŸ‘", e2: "ğŸŒŠ", s1: "Valla fÃ¥r.", s2: "Vattnet vÃ¤llar." },
            { pair: ["A", "Ã„"], w1: "Hamn", d1: "Ù…ÙŠÙ†Ø§Ø¡", w2: "HÃ¤mn", d2: "Ø§Ù†ØªÙ‚Ø§Ù…", frame: "H_mn", e1: "âš“", e2: "ğŸ˜ˆ", s1: "BÃ¥ten i hamnen.", s2: "Ta hÃ¤mnd." },
            { pair: ["A", "Ã„"], w1: "Landa", d1: "ÙŠÙ‡Ø¨Ø·", w2: "LÃ¤nda", d2: "ÙŠÙ…ØªØ¯", frame: "L_nda", e1: "âœˆï¸", e2: "ğŸ“", s1: "Flyget landar.", s2: "Det lÃ¤ndar dit." },
            { pair: ["A", "Ã„"], w1: "Panna", d1: "Ø¬Ø¨ÙŠÙ†", w2: "PÃ¤nna", d2: "Ù‚Ù„Ù…", frame: "P_nna", e1: "ğŸ§ ", e2: "âœï¸", s1: "Svettig panna.", s2: "Min penna." },
            { pair: ["A", "Ã„"], w1: "Tang", d1: "ÙƒÙ…Ø§Ø´Ø©", w2: "TÃ¤ng", d2: "Ø·Ø­Ø§Ù„Ø¨", frame: "T_ng", e1: "ğŸ”§", e2: "ğŸŒ¿", s1: "En tÃ¥ng fÃ¶r att greppa.", s2: "TÃ¥ng pÃ¥ stranden." },
            { pair: ["A", "Ã„"], w1: "Trast", d1: "Ø³Ù…Ù†Ø©", w2: "TrÃ¤st", d2: "Ø¹Ø²Ø§Ø¡", frame: "Tr_st", e1: "ğŸ¦", e2: "ğŸ¤—", s1: "En trast sjunger.", s2: "TrÃ¶st i sorgen." },

            // === Ã… vs O (20 pairs) ===
            { pair: ["Ã…", "O"], w1: "KÃ¥l", d1: "Ù…Ù„ÙÙˆÙ", w2: "Kol", d2: "ÙØ­Ù…", frame: "K_l", e1: "ğŸ¥¬", e2: "âš«", s1: "Vi Ã¥t kÃ¥lsoppa.", s2: "Vi grillade med kol." },
            { pair: ["Ã…", "O"], w1: "HÃ¥l", d1: "Ø«Ù‚Ø¨", w2: "Hol", d2: "Ø¬Ø²ÙŠØ±Ø©", frame: "H_l", e1: "ğŸ•³ï¸", e2: "ğŸï¸", s1: "HÃ¥l i strumpan.", s2: "En liten holme." },
            { pair: ["Ã…", "O"], w1: "TÃ¥l", d1: "ÙŠØªØ­Ù…Ù„", w2: "Tol", d2: "ØªØ±Ø¬Ù…", frame: "T_l", e1: "ğŸ’ª", e2: "ğŸ“–", s1: "Han tÃ¥l smÃ¤rta.", s2: "Hon tolkade." },
            { pair: ["Ã…", "O"], w1: "MÃ¥l", d1: "Ù‡Ø¯Ù", w2: "Mol", d2: "Ø¬Ø²ÙŠØ¡", frame: "M_l", e1: "ğŸ¯", e2: "ğŸ”¬", s1: "Mitt mÃ¥l Ã¤r klart.", s2: "En mol i kemin." },
            { pair: ["Ã…", "O"], w1: "Ã…l", d1: "Ø«Ø¹Ø¨Ø§Ù† Ø¨Ø­Ø±", w2: "Ol", d2: "Ø¨ÙŠØ±Ø©", frame: "_l", e1: "ğŸ", e2: "ğŸº", s1: "En lÃ¥ng Ã¥l.", s2: "En Ã¶l, tack!" },
            { pair: ["Ã…", "O"], w1: "StÃ¥l", d1: "ÙÙˆÙ„Ø§Ø°", w2: "Stol", d2: "ÙƒØ±Ø³ÙŠ", frame: "St_l", e1: "ğŸ”©", e2: "ğŸª‘", s1: "Rostfritt stÃ¥l.", s2: "Sitt pÃ¥ stolen." },
            { pair: ["Ã…", "O"], w1: "GÃ¥s", d1: "Ø¥ÙˆØ²Ø©", w2: "Gos", d2: "Ø¯Ù„Ø§Ù„", frame: "G_s", e1: "ğŸ¦¢", e2: "ğŸ¤—", s1: "En vit gÃ¥s.", s2: "Lite gos." },
            { pair: ["Ã…", "O"], w1: "LÃ¥s", d1: "Ù‚ÙÙ„", w2: "Los", d2: "ÙˆØ´Ù‚", frame: "L_s", e1: "ğŸ”’", e2: "ğŸ±", s1: "LÃ¥s dÃ¶rren.", s2: "En los i skogen." },
            { pair: ["Ã…", "O"], w1: "BÃ¥s", d1: "Ù…Ù‚ØµÙˆØ±Ø©", w2: "Bos", d2: "Ø¹Ø´", frame: "B_s", e1: "ğŸš¿", e2: "ğŸ¦", s1: "DuschbÃ¥s.", s2: "FÃ¥gelbos." },
            { pair: ["Ã…", "O"], w1: "RÃ¥s", d1: "Ø­Ø¯ÙˆØ¯", w2: "Ros", d2: "ÙˆØ±Ø¯Ø©", frame: "R_s", e1: "ğŸ“", e2: "ğŸŒ¹", s1: "En gammal rÃ¥.", s2: "En rÃ¶d ros." },
            { pair: ["Ã…", "O"], w1: "TÃ¥r", d1: "Ø¯Ù…Ø¹Ø©", w2: "Tor", d2: "Ø¬Ø§Ù", frame: "T_r", e1: "ğŸ˜¢", e2: "ğŸœï¸", s1: "En tÃ¥r i Ã¶gat.", s2: "Torr mark." },
            { pair: ["Ã…", "O"], w1: "VÃ¥r", d1: "Ø±Ø¨ÙŠØ¹", w2: "Vor", d2: "ØµØ¯ÙŠØ¯", frame: "V_r", e1: "ğŸŒ¸", e2: "ğŸ©¹", s1: "VÃ¥ren kommer.", s2: "Var i sÃ¥ret." },
            { pair: ["Ã…", "O"], w1: "TrÃ¥l", d1: "Ø´Ø¨ÙƒØ© ØµÙŠØ¯", w2: "Trol", d2: "ÙŠØ³Ø­Ø±", frame: "Tr_l", e1: "ğŸ£", e2: "ğŸ§™", s1: "En fisktrÃ¥l.", s2: "Han trollade." },
            { pair: ["Ã…", "O"], w1: "SkÃ¥l", d1: "ÙÙŠ ØµØ­ØªÙƒ", w2: "Skol", d2: "Ù…Ø¯Ø±Ø³Ø©", frame: "Sk_l", e1: "ğŸ¥‚", e2: "ğŸ«", s1: "SkÃ¥l!", s2: "GÃ¥ till skolan." },
            { pair: ["Ã…", "O"], w1: "PÃ¥l", d1: "Ø¹Ù…ÙˆØ¯", w2: "Pol", d2: "Ù‚Ø·Ø¨", frame: "P_l", e1: "ğŸªµ", e2: "ğŸ§­", s1: "En trÃ¤pÃ¥le.", s2: "Nordpolen." },
            { pair: ["Ã…", "O"], w1: "NÃ¥l", d1: "Ø¥Ø¨Ø±Ø©", w2: "Nol", d2: "ØµÙØ±", frame: "N_l", e1: "ğŸª¡", e2: "0ï¸âƒ£", s1: "Sy med en nÃ¥l.", s2: "Noll poÃ¤ng." },
            { pair: ["Ã…", "O"], w1: "BÃ¥l", d1: "Ù†Ø§Ø± Ù…Ø®ÙŠÙ…", w2: "Bol", d2: "Ø¹Ø´", frame: "B_l", e1: "ğŸ”¥", e2: "ğŸ", s1: "Sitta vid bÃ¥let.", s2: "Ett getingbol." },
            { pair: ["Ã…", "O"], w1: "FÃ¥l", d1: "Ù…Ù‡Ø±", w2: "Fol", d2: "Ø´Ø¹Ø¨", frame: "F_l", e1: "ğŸ´", e2: "ğŸ‘¥", s1: "Ett ungt fÃ¶l.", s2: "Folket rÃ¶star." },
            { pair: ["Ã…", "O"], w1: "SÃ¥r", d1: "Ø¬Ø±Ø­", w2: "Sor", d2: "Ù‡Ù…Ù‡Ù…Ø©", frame: "S_r", e1: "ğŸ©¹", e2: "ğŸ’¤", s1: "Ett djupt sÃ¥r.", s2: "Han sorlade." },
            { pair: ["Ã…", "O"], w1: "HÃ¥r", d1: "Ø´Ø¹Ø±", w2: "Hor", d2: "Ø²Ù†Ù‰", frame: "H_r", e1: "ğŸ’‡", e2: "ğŸ’”", s1: "LÃ¥ngt hÃ¥r.", s2: "Hor Ã¤r synd." },

            // === I vs E (15 pairs) ===
            { pair: ["I", "E"], w1: "Fil", d1: "Ù…Ù„Ù", w2: "Fel", d2: "Ø®Ø·Ø£", frame: "F_l", e1: "ğŸ“", e2: "âŒ", s1: "Skicka mig en fil.", s2: "Det blev fel." },
            { pair: ["I", "E"], w1: "Vi", d1: "Ù†Ø­Ù†", w2: "Ve", d2: "ÙˆÙŠÙ„", frame: "V_", e1: "ğŸ¤—", e2: "ğŸ˜±", s1: "Vi ska resa bort.", s2: "Ve och fasa." },
            { pair: ["I", "E"], w1: "Bit", d1: "Ù‚Ø·Ø¹Ø©", w2: "Bet", d2: "Ø¹Ø¶", frame: "B_t", e1: "ğŸ°", e2: "ğŸ¦·", s1: "En liten bit.", s2: "Hunden bet." },
            { pair: ["I", "E"], w1: "Lid", d1: "ÙŠØ¹Ø§Ù†ÙŠ", w2: "Led", d2: "Ù‚Ø§Ø¯", frame: "L_d", e1: "ğŸ˜¢", e2: "ğŸ‘†", s1: "Han lider av smÃ¤rta.", s2: "Hon ledde vÃ¤gen." },
            { pair: ["I", "E"], w1: "Sin", d1: "Ù…Ù„ÙƒÙ‡", w2: "Sen", d2: "Ù…ØªØ£Ø®Ø±", frame: "S_n", e1: "ğŸ‘¤", e2: "â°", s1: "Hans sin bil.", s2: "Du Ã¤r sen." },
            { pair: ["I", "E"], w1: "Min", d1: "Ù…Ù„ÙƒÙŠ", w2: "Men", d2: "Ù„ÙƒÙ†", frame: "M_n", e1: "ğŸ‘†", e2: "ğŸ”„", s1: "Min bok.", s2: "Men Ã¤ndÃ¥." },
            { pair: ["I", "E"], w1: "Rim", d1: "Ù‚Ø§ÙÙŠØ©", w2: "Rem", d2: "Ø­Ø²Ø§Ù…", frame: "R_m", e1: "ğŸ“", e2: "âŒš", s1: "Ord som rimmar.", s2: "En klockrem." },
            { pair: ["I", "E"], w1: "Sik", d1: "Ø³Ù…Ùƒ", w2: "Sek", d2: "Ø«Ø§Ù†ÙŠØ©", frame: "S_k", e1: "ğŸŸ", e2: "â±ï¸", s1: "En sik i sjÃ¶n.", s2: "NÃ¥gra sekunder." },
            { pair: ["I", "E"], w1: "Vik", d1: "Ø®Ù„ÙŠØ¬", w2: "Vek", d2: "Ø·ÙˆÙ‰", frame: "V_k", e1: "ğŸ–ï¸", e2: "ğŸ“„", s1: "En vacker vik.", s2: "Han vek pappret." },
            { pair: ["I", "E"], w1: "Pil", d1: "Ø³Ù‡Ù…", w2: "Pel", d2: "Ø¹Ù…ÙˆØ¯", frame: "P_l", e1: "ğŸ¹", e2: "ğŸ›ï¸", s1: "En pil i luften.", s2: "En pelare." },
            { pair: ["I", "E"], w1: "Rit", d1: "Ø±Ø³Ù…", w2: "Ret", d2: "Ø£Ø²Ø¹Ø¬", frame: "R_t", e1: "âœï¸", e2: "ğŸ˜¤", s1: "Jag ritade.", s2: "Det retade mig." },
            { pair: ["I", "E"], w1: "Skrift", d1: "ÙƒØªØ§Ø¨Ø©", w2: "Skeft", d2: "Ù…Ø§Ø¦Ù„", frame: "Skr_ft", e1: "âœï¸", e2: "ğŸ“", s1: "Ã„ldre skrift.", s2: "En skev linje." },
            { pair: ["I", "E"], w1: "Gripa", d1: "ÙŠÙ…Ø³Ùƒ", w2: "Grepa", d2: "Ø´ÙˆÙƒØ©", frame: "Gr_pa", e1: "ğŸ¤²", e2: "ğŸ”±", s1: "Gripa tag i.", s2: "En halmgrep." },
            { pair: ["I", "E"], w1: "Stig", d1: "Ù…Ù…Ø±", w2: "Steg", d2: "Ø®Ø·ÙˆØ©", frame: "St_g", e1: "ğŸ›¤ï¸", e2: "ğŸ‘£", s1: "En smal stig.", s2: "Ett stort steg." },
            { pair: ["I", "E"], w1: "Vin", d1: "Ù†Ø¨ÙŠØ°", w2: "Ven", d2: "ØµÙÙŠØ±", frame: "V_n", e1: "ğŸ·", e2: "ğŸ’¨", s1: "RÃ¶tt vin.", s2: "Vinden ven." },

            // === I vs Y (12 pairs) ===
            { pair: ["I", "Y"], w1: "Fil", d1: "Ù„Ø¨Ù†", w2: "Fyl", d2: "Ø³ÙƒÙŠØ±", frame: "F_l", e1: "ğŸ¥›", e2: "ğŸ¥´", s1: "Jag Ã¤ter fil.", s2: "Ett fyllo sov." },
            { pair: ["I", "Y"], w1: "Sill", d1: "Ø±Ù†Ø¬Ø©", w2: "Syll", d2: "Ø¹ØªØ¨Ø©", frame: "S_ll", e1: "ğŸŸ", e2: "ğŸšª", s1: "Sill Ã¤r gott.", s2: "Syllen i huset." },
            { pair: ["I", "Y"], w1: "Vit", d1: "Ø£Ø¨ÙŠØ¶", w2: "Vyt", d2: "ØµØ§Ø­", frame: "V_t", e1: "âšª", e2: "ğŸ“¢", s1: "En vit klÃ¤nning.", s2: "Hon vyter." },
            { pair: ["I", "Y"], w1: "Bit", d1: "Ù‚Ø·Ø¹Ø©", w2: "Byt", d2: "Ø¨Ø§Ø¯Ù„", frame: "B_t", e1: "ğŸ°", e2: "ğŸ”„", s1: "En bit kaka.", s2: "Byt klÃ¤der." },
            { pair: ["I", "Y"], w1: "Bil", d1: "Ø³ÙŠØ§Ø±Ø©", w2: "Byl", d2: "Ø«ÙˆØ±", frame: "B_l", e1: "ğŸš—", e2: "ğŸ‚", s1: "En rÃ¶d bil.", s2: "En stor tyr." },
            { pair: ["I", "Y"], w1: "Sim", d1: "Ø³Ø¨Ø§Ø­Ø©", w2: "Sym", d2: "Ø®ÙŠØ§Ø·Ø©", frame: "S_m", e1: "ğŸŠ", e2: "ğŸ§µ", s1: "Jag gillar att simma.", s2: "Symaskinen." },
            { pair: ["I", "Y"], w1: "Kil", d1: "ÙˆØªØ¯", w2: "Kyl", d2: "Ø«Ù„Ø§Ø¬Ø©", frame: "K_l", e1: "ğŸ”¨", e2: "â„ï¸", s1: "En trÃ¤kil.", s2: "LÃ¤gg i kylen." },
            { pair: ["I", "Y"], w1: "Rit", d1: "Ø±Ø³Ù…", w2: "Ryt", d2: "Ø²Ù…Ø¬Ø±", frame: "R_t", e1: "âœï¸", e2: "ğŸ¦", s1: "Jag ritade.", s2: "Lejonet ryter." },
            { pair: ["I", "Y"], w1: "Lid", d1: "ÙŠØ¹Ø§Ù†ÙŠ", w2: "Lyd", d2: "ÙŠØ·ÙŠØ¹", frame: "L_d", e1: "ğŸ˜¢", e2: "ğŸ¯", s1: "Han lider.", s2: "Lyd reglerna." },
            { pair: ["I", "Y"], w1: "Stil", d1: "Ø£Ø³Ù„ÙˆØ¨", w2: "Styl", d2: "Ø±ÙƒÙŠØ²Ø©", frame: "St_l", e1: "ğŸ’…", e2: "ğŸ—ï¸", s1: "Fin stil.", s2: "En stylta." },
            { pair: ["I", "Y"], w1: "Pir", d1: "Ø±ØµÙŠÙ", w2: "Pyr", d2: "ÙŠØ´ØªØ¹Ù„", frame: "P_r", e1: "âš“", e2: "ğŸ”¥", s1: "En lÃ¥ng pir.", s2: "Elden pyr." },
            { pair: ["I", "Y"], w1: "Gris", d1: "Ø®Ù†Ø²ÙŠØ±", w2: "Grys", d2: "ÙØ¬Ø±", frame: "Gr_s", e1: "ğŸ·", e2: "ğŸŒ…", s1: "En rosa gris.", s2: "I gryningen." }
        ];

        // ==========================================
        // STATE
        // ==========================================
        const TOTAL_STAGES = 50;
        const LEVELS_PER_STAGE = 5;

        // Load saved stage if available
        let savedStage = localStorage.getItem('vowelGameStage');
        let currentStage = savedStage ? parseInt(savedStage) : 1;
        let currentLevel = 1; // 1 to 7
        let currentPair = null;
        let lives = 3;
        let streak = 0;
        let score = 0;
        let isProcessing = false;
        let levelStartTime = 0;
        let isBossWave = false;
        let solvedStatus = { 1: false, 2: false };
        let failedStatus = { 1: false, 2: false }; // Track failures distinct from solved
        let currentTarget = 1;
        let hasStarted = false;

        // Persistent Question History
        let seenIndices = [];
        try {
            seenIndices = JSON.parse(localStorage.getItem('vowelPlayedIndices') || '[]');
        } catch (e) { seenIndices = []; }

        // Fisher-Yates Shuffle for true randomization
        function shuffleArray(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        // Elements
        const optionsArea = document.getElementById('optionsArea');
        const feedbackOverlay = document.getElementById('feedbackOverlay');
        const progressBar = document.getElementById('progressBar');
        const levelBadge = document.getElementById('levelBadge');
        const cardFlipper = document.getElementById('cardFlipper');
        const speedBadge = document.getElementById('speedBadge');
        const bossBanner = document.getElementById('bossBanner');
        const livesContainer = document.getElementById('livesContainer');
        const startScreen = document.getElementById('startScreen');
        const playArea = document.getElementById('playArea');

        // Tilt Logic
        const container = document.querySelector('.game-container');
        container.addEventListener('mousemove', (e) => {
            if (isProcessing || !hasStarted) return;
            const rect = container.getBoundingClientRect();
            const x = e.clientX - rect.left; const y = e.clientY - rect.top;
            const centerX = rect.width / 2; const centerY = rect.height / 2;
            const rotateX = ((y - centerY) / centerY) * -5; const rotateY = ((x - centerX) / centerX) * 5;
            cardFlipper.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        });
        container.addEventListener('mouseleave', () => { cardFlipper.style.transform = `rotateX(0) rotateY(0)`; });

        function startGame() {
            startScreen.style.opacity = '0';
            setTimeout(() => {
                startScreen.style.display = 'none';
                playArea.style.display = 'block';
                hasStarted = true;
                initGame();
            }, 500);
        }

        function initGame() {
            window.speechSynthesis.getVoices();
            // Load Saved Stage
            let saved = localStorage.getItem('vowelGameStage');
            currentStage = saved ? parseInt(saved) : 1;
            currentLevel = 1;
            score = 0; lives = 3; streak = 0;
            updateLives();
            setupDropZones(); // Fix: Initialize drop zones
            loadLevel();
        }

        function setupDropZones() {
            // Mouse Drag Support
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault(); // Necessary to allow dropping
                    if (!zone.classList.contains('solved')) {
                        zone.classList.add('drag-over');
                        e.dataTransfer.dropEffect = 'move';
                    }
                });

                zone.addEventListener('dragleave', (e) => {
                    zone.classList.remove('drag-over');
                });

                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    if (zone.classList.contains('solved')) return;

                    const vowel = e.dataTransfer.getData('text/plain');
                    if (vowel) {
                        const slotId = parseInt(zone.dataset.slot);
                        // Only accept answers on the current target slot
                        if (slotId === currentTarget) {
                            handleAnswer(vowel, null, slotId);
                        }
                    }
                });
            });
        }

        function updateLives() {
            livesContainer.innerHTML = '';
            for (let i = 0; i < 3; i++) {
                const h = document.createElement('span');
                h.className = `heart ${i < lives ? '' : 'lost'}`;
                h.textContent = 'â¤ï¸';
                livesContainer.appendChild(h);
            }
        }

        function checkSkins() {
            document.body.classList.remove('skin-neon', 'skin-gold');
            if (streak > 5) document.body.classList.add('skin-neon');
            if (score > 2000) document.body.classList.add('skin-gold');
        }

        function loadLevel() {
            if (isProcessing) return;

            // Check Win Condition (Max Stages)
            if (currentStage > TOTAL_STAGES) {
                showEndScreen(true);
                return;
            }

            // Boss Check: Last level of stage (Level 7)
            isBossWave = (currentLevel === LEVELS_PER_STAGE);
            document.body.classList.toggle('boss-mode', isBossWave);
            bossBanner.innerHTML = isBossWave ? 'ğŸ”¥ BOSS LEVEL ğŸ”¥' : '';
            bossBanner.style.display = isBossWave ? 'block' : 'none';

            levelBadge.textContent = `Stage ${currentStage} â€¢ Level ${currentLevel}/${LEVELS_PER_STAGE}`;

            // Progress Bar (Overall Progress)
            const totalLevelsPlayed = ((currentStage - 1) * LEVELS_PER_STAGE) + currentLevel;
            const totalLevels = TOTAL_STAGES * LEVELS_PER_STAGE;
            progressBar.style.width = `${(totalLevelsPlayed / totalLevels) * 100}%`;

            checkSkins();

            // Reset Card with Slide Animation
            cardFlipper.classList.remove('flipped');
            cardFlipper.classList.remove('slide-in');
            void cardFlipper.offsetWidth; // Force Reflow
            cardFlipper.classList.add('slide-in');

            speedBadge.classList.remove('visible');
            feedbackOverlay.classList.remove('visible');
            document.getElementById('inlineCountdown').classList.remove('visible');
            levelStartTime = Date.now();

            document.getElementById('inlineCountdown').classList.remove('visible');
            levelStartTime = Date.now();

            // Get Next Pair (Persistent)
            currentPair = getNextPair();

            solvedStatus = { 1: false, 2: false };
            failedStatus = { 1: false, 2: false };
            currentTarget = 1;

            const p = currentPair;
            // Fix: Use Regex for case-insensitive replacement (O -> o in Son)
            let frame1 = p.w1.replace(new RegExp(p.pair[0], 'i'), '<span class="missing-vowel"></span>');
            let frame2 = p.w2.replace(new RegExp(p.pair[1], 'i'), '<span class="missing-vowel"></span>');

            document.querySelector('.word-1-text').innerHTML = frame1;
            document.querySelector('.word-2-text').innerHTML = frame2;
            document.querySelector('.word-1-def').innerText = p.d1;
            document.querySelector('.word-2-def').innerText = p.d2;
            document.getElementById('emoji1').textContent = p.e1 || 'ğŸ“¦';
            document.getElementById('emoji2').textContent = p.e2 || 'ğŸ“¦';

            document.getElementById('backEmoji1').textContent = p.e1 || '';
            document.getElementById('backEmoji2').textContent = p.e2 || '';
            document.getElementById('sentence1').innerHTML = (p.s1 || "").replace(new RegExp(p.w1.substr(0, 3), 'gi'), m => `<em>${m}</em>`);
            document.getElementById('sentence2').innerHTML = (p.s2 || "").replace(new RegExp(p.w2.substr(0, 3), 'gi'), m => `<em>${m}</em>`);

            updateTargetStyling();

            // All Swedish vowels for distractors
            const allVowels = ['A', 'E', 'I', 'O', 'U', 'Y', 'Ã…', 'Ã„', 'Ã–'];
            const correctVowels = p.pair;

            // Get 2 distractor vowels (not in the pair)
            const distractors = shuffleArray(allVowels
                .filter(v => !correctVowels.includes(v)))
                .slice(0, 2);

            // Combine and shuffle all 4 options
            const allOptions = shuffleArray([...correctVowels, ...distractors]);

            optionsArea.innerHTML = '';
            allOptions.forEach(v => {
                const btn = document.createElement('button');
                btn.className = 'vowel-btn slide-in';
                btn.textContent = v;
                btn.draggable = true;
                setupInteractions(btn, v);
                optionsArea.appendChild(btn);
            });
        }

        function updateTargetStyling() {
            [1, 2].forEach(id => {
                const el = document.getElementById(`slot${id}`);
                el.classList.remove('active-target', 'solved', 'wrong');

                if (failedStatus[id]) el.classList.add('wrong'); // Priority to fail
                else if (solvedStatus[id]) el.classList.add('solved');
                else if (id === currentTarget) el.classList.add('active-target');
            });
        }

        function setupInteractions(btn, vowel) {
            btn.addEventListener('click', () => animateFly(vowel, btn, currentTarget));

            // Mouse Drag
            btn.addEventListener('dragstart', (e) => {
                btn.classList.add('dragging');
                e.dataTransfer.setData('text/plain', vowel);
                e.dataTransfer.effectAllowed = 'move';
            });
            btn.addEventListener('dragend', () => {
                btn.classList.remove('dragging');
                document.querySelectorAll('.word-item').forEach(e => e.classList.remove('drag-over'));
            });

            // Touch Drag (Full Support)
            btn.addEventListener('touchstart', (e) => handleTouchStart(e, btn), { passive: false });
            btn.addEventListener('touchmove', handleTouchMove, { passive: false });
            btn.addEventListener('touchend', (e) => handleTouchEnd(e, btn, vowel));
        }

        // Touch Logic
        let touchClone = null;
        let touchOffset = { x: 0, y: 0 };

        function handleTouchStart(e, btn) {
            if (isProcessing) return;
            const touch = e.touches[0];
            const rect = btn.getBoundingClientRect();
            touchOffset.x = touch.clientX - rect.left;
            touchOffset.y = touch.clientY - rect.top;

            btn.classList.add('dragging');

            // Create visual clone for dragging
            touchClone = btn.cloneNode(true);
            touchClone.style.position = 'fixed';
            touchClone.style.width = rect.width + 'px';
            touchClone.style.height = rect.height + 'px';
            touchClone.style.left = rect.left + 'px';
            touchClone.style.top = rect.top + 'px';
            touchClone.style.zIndex = '2000';
            touchClone.style.pointerEvents = 'none';
            touchClone.style.opacity = '0.9';
            touchClone.style.transform = 'scale(1.1)';
            touchClone.style.boxShadow = '0 10px 20px rgba(0,0,0,0.5)';
            document.body.appendChild(touchClone);
        }

        function getNextPair() {
            // Find indices not yet seen
            let available = minimalPairsData.map((_, i) => i).filter(i => !seenIndices.includes(i));

            // If all seen, reset history (start new cycle)
            if (available.length === 0) {
                const lastSeen = seenIndices[seenIndices.length - 1]; // Last text played
                seenIndices = [];
                available = minimalPairsData.map((_, i) => i);

                // Prevent immediate repeat of the very last word
                if (available.length > 1) {
                    available = available.filter(i => i !== lastSeen);
                }
            }

            // Pick random
            const randIndex = available[Math.floor(Math.random() * available.length)];

            // Save to history
            seenIndices.push(randIndex);
            localStorage.setItem('vowelPlayedIndices', JSON.stringify(seenIndices));

            return minimalPairsData[randIndex];
        }

        function handleTouchMove(e) {
            if (!touchClone) return;
            e.preventDefault(); // Prevent scrolling while dragging
            const touch = e.touches[0];
            touchClone.style.left = (touch.clientX - touchOffset.x) + 'px';
            touchClone.style.top = (touch.clientY - touchOffset.y) + 'px';

            // Highlight Drop Zones
            const target = document.elementFromPoint(touch.clientX, touch.clientY);
            const dropZone = target ? target.closest('.drop-zone') : null;
            document.querySelectorAll('.word-item').forEach(el => el.classList.remove('drag-over'));
            if (dropZone && !dropZone.classList.contains('solved')) {
                dropZone.classList.add('drag-over');
            }
        }

        function handleTouchEnd(e, btn, vowel) {
            if (!touchClone) return;
            const touch = e.changedTouches[0];
            const target = document.elementFromPoint(touch.clientX, touch.clientY);
            const dropZone = target ? target.closest('.drop-zone') : null;

            // Cleanup
            document.body.removeChild(touchClone);
            touchClone = null;
            btn.classList.remove('dragging');
            document.querySelectorAll('.word-item').forEach(el => el.classList.remove('drag-over'));

            if (dropZone && !dropZone.classList.contains('solved')) {
                const slotId = parseInt(dropZone.dataset.slot);
                // Only accept answers on the current target slot
                if (slotId === currentTarget) {
                    handleAnswer(vowel, btn, slotId);
                }
            }
        }

        function animateFly(vowel, btnEl, targetSlotId) {
            if (isProcessing || solvedStatus[targetSlotId]) return;
            isProcessing = true;

            // Spawn Clone
            const clone = btnEl.cloneNode(true);
            clone.classList.add('flying-clone');
            const rect = btnEl.getBoundingClientRect();
            clone.style.left = rect.left + 'px'; clone.style.top = rect.top + 'px';
            document.body.appendChild(clone);

            const targetEl = document.getElementById(`slot${targetSlotId}`);
            const tRect = targetEl.getBoundingClientRect();

            // Animate
            setTimeout(() => {
                clone.style.left = (tRect.left + tRect.width / 2 - 25) + 'px';
                clone.style.top = (tRect.top + tRect.height / 2 - 25) + 'px';
                clone.style.transform = 'scale(0.5)'; clone.style.opacity = '0';
            }, 10);

            setTimeout(() => { document.body.removeChild(clone); isProcessing = false; handleAnswer(vowel, btnEl, targetSlotId); }, 400); // Fast 400ms
        }

        // ==========================================
        // PARTICLE EFFECTS SYSTEM
        // ==========================================
        function spawnParticle(x, y, type, emoji) {
            const particle = document.createElement('div');
            particle.className = `particle ${type}`;
            particle.textContent = emoji;
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';

            // Random direction
            const angle = Math.random() * Math.PI * 2;
            const distance = 50 + Math.random() * 100;
            particle.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
            particle.style.setProperty('--ty', Math.sin(angle) * distance + 'px');

            document.body.appendChild(particle);
            setTimeout(() => particle.remove(), 1000);
        }

        function burstParticles(element, type) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            const particles = {
                star: { emojis: ['â­', 'âœ¨', 'ğŸŒŸ'], count: 8 },
                flame: { emojis: ['ğŸ”¥', 'ğŸ’¥', 'âš¡'], count: 12 },
                sparkle: { emojis: ['ğŸ’œ', 'ğŸ’«', 'âœ¨'], count: 10 }
            };

            const config = particles[type] || particles.star;

            for (let i = 0; i < config.count; i++) {
                setTimeout(() => {
                    const emoji = config.emojis[Math.floor(Math.random() * config.emojis.length)];
                    spawnParticle(centerX, centerY, type, emoji);
                }, i * 50);
            }
        }

        function triggerCorrectAnswerEffect(slotId) {
            const slotEl = document.getElementById(`slot${slotId}`);

            if (streak >= 5) {
                // Flame burst for high streak
                burstParticles(slotEl, 'flame');
            } else if (streak >= 3) {
                // Sparkle for medium streak
                burstParticles(slotEl, 'sparkle');
            } else {
                // Stars for normal correct
                burstParticles(slotEl, 'star');
            }
        }

        // TTS using Google Translate for high quality Swedish pronunciation
        let vgAudio = null;
        const isIOS_VG = /iPad|iPhone|iPod/.test(navigator.userAgent) ||
            (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);

        function playAudioForSlot(id) {
            const w = id === 1 ? currentPair.w1 : currentPair.w2;
            if (!w) return;

            // Stop any existing audio
            if (vgAudio) {
                vgAudio.pause();
                vgAudio.currentTime = 0;
            }

            // Use Google Translate TTS for best quality
            vgAudio = new Audio();
            vgAudio.src = `https://translate.google.com/translate_tts?ie=UTF-8&tl=sv&client=tw-ob&q=${encodeURIComponent(w)}`;
            vgAudio.volume = 1.0;
            vgAudio.playbackRate = 0.7; // Slower for learning

            vgAudio.play().then(() => {
                console.log('Playing Swedish TTS for:', w);
            }).catch(err => {
                console.warn('Google TTS failed, trying local:', err);
                playLocalTTS_VG(w);
            });

            vgAudio.onerror = () => {
                console.warn('Audio error, falling back to local TTS');
                playLocalTTS_VG(w);
            };
        }

        // Local TTS fallback
        let swedishVoice = null;

        function getSwedishVoice() {
            if (swedishVoice) return swedishVoice;
            const voices = window.speechSynthesis.getVoices();
            const sv = voices.filter(v => v.lang.startsWith('sv'));
            if (sv.length > 0) {
                swedishVoice = sv.find(v => v.name.includes('Alva')) ||
                    sv.find(v => v.name.includes('Klara')) ||
                    sv[0];
            }
            return swedishVoice;
        }

        function playLocalTTS_VG(text) {
            if (!window.speechSynthesis) return;
            speechSynthesis.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.voice = getSwedishVoice();
            utterance.lang = 'sv-SE';
            utterance.rate = 0.85;
            utterance.volume = 1.0;
            window.speechSynthesis.speak(utterance);
        }

        // Initialize voices
        if (window.speechSynthesis) {
            speechSynthesis.onvoiceschanged = () => {
                swedishVoice = null;
                getSwedishVoice();
            };
            speechSynthesis.getVoices();
        }

        function showComboText(text) {
            const el = document.createElement('div');
            el.className = 'combo-text';
            el.textContent = text;
            const rect = document.getElementById('livesContainer').getBoundingClientRect();
            el.style.left = (rect.left - 50) + 'px';
            el.style.top = (rect.top + 20) + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        function handleAnswer(selectedVowel, btnEl, slotId) {
            if (isProcessing) return;
            const expectedVowel = slotId === 1 ? currentPair.pair[0] : currentPair.pair[1];

            if (selectedVowel === expectedVowel) {
                solvedStatus[slotId] = true;
                failedStatus[slotId] = false; // Clear failure if corrected
                const slotEl = document.getElementById(`slot${slotId}`);
                slotEl.classList.add('solved');
                slotEl.classList.remove('wrong'); // Fix: Remove red border if corrected

                const fullWord = slotId === 1 ? currentPair.w1 : currentPair.w2;
                if (slotId === 1) document.querySelector('.word-1-text').innerHTML = fullWord;
                else document.querySelector('.word-2-text').innerHTML = fullWord;

                if (btnEl) btnEl.classList.add('selected-correct'); // Guarded
                playAudioForSlot(slotId);
                triggerCorrectAnswerEffect(slotId); // Particle burst!
                streak++;
                score += 100 * (streak > 5 ? 2 : 1);

                // Combo Visuals
                if (streak % 5 === 0) showComboText(`${streak}x COMBO!`);
                else if (streak === 3) showComboText("HEATING UP!");

                if (solvedStatus[1] && solvedStatus[2]) {
                    levelComplete();
                } else {
                    currentTarget = slotId === 1 ? 2 : 1;
                    updateTargetStyling();
                    if (streak > 3) playAudioForSlot(currentTarget);
                }
            } else {
                if (btnEl) btnEl.classList.add('selected-wrong'); // Guarded
                lives--; streak = 0; updateLives();
                if (window.navigator.vibrate) window.navigator.vibrate(400);

                // Reveal Answer in RED and Continue
                solvedStatus[slotId] = true;
                failedStatus[slotId] = true; // Mark as failed persistence
                const slotEl = document.getElementById(`slot${slotId}`);
                slotEl.classList.add('wrong');

                // Show the USER'S choice (even if wrong) so they see "BÃ¶l" instead of "Bol"
                // Match case logic: If "_" is at start, Keep Case. If middle, Lowercase.
                // Simple heuristic: Check frame index 0.
                const isStart = currentPair.frame.indexOf('_') === 0;
                const vDisplay = isStart ? selectedVowel.toUpperCase() : selectedVowel.toLowerCase();
                const wrongWord = currentPair.frame.replace('_', vDisplay);

                if (slotId === 1) document.querySelector('.word-1-text').innerText = wrongWord;
                else document.querySelector('.word-2-text').innerText = wrongWord;

                if (lives <= 0) {
                    showEndScreen(false);
                } else {
                    // Continue Flow
                    if (solvedStatus[1] && solvedStatus[2]) {
                        levelComplete();
                    } else {
                        currentTarget = slotId === 1 ? 2 : 1;
                        updateTargetStyling();
                    }
                }
            }
        }

        function levelComplete() {
            isProcessing = true;
            const timeTaken = Date.now() - levelStartTime;
            if (timeTaken < 5000) { speedBadge.classList.add('visible'); score += 50; }

            // Hide Boss Banner during transition to avoid confusion
            document.getElementById('bossBanner').style.display = 'none';

            setTimeout(() => { cardFlipper.classList.add('flipped'); }, 600);

            // Wait for user to read context (reduced to 1s based on request)
            setTimeout(() => {
                startCountdown();
            }, 1000);
        }

        function startCountdown() {
            const container = document.getElementById('inlineCountdown');
            // Update Text based on context
            const isStageClear = (currentLevel === LEVELS_PER_STAGE);
            const msg = isStageClear ? "NEXT STAGE" : "NEXT LEVEL";

            container.innerHTML = `<div class="countdown-number" id="cNum">3</div><div class="countdown-text">${msg}</div>`;
            container.classList.add('visible');

            let count = 3;
            const numEl = container.querySelector('#cNum');

            const timer = setInterval(() => {
                count--;
                if (count > 0) {
                    numEl.textContent = count;
                } else {
                    clearInterval(timer);
                    container.classList.remove('visible');

                    // Progression Logic
                    if (currentLevel < LEVELS_PER_STAGE) {
                        currentLevel++;
                    } else {
                        // Stage Complete!
                        currentStage++;
                        currentLevel = 1;

                        // Default Reward: +1 Heart (Max 5)
                        if (lives < 5) {
                            lives++;
                            updateLives();
                            showComboText("+1 â¤ï¸");
                        }

                        // Save Progress Explicitly
                        try {
                            localStorage.setItem('vowelGameStage', currentStage.toString());
                        } catch (e) { console.error("Save failed", e); }

                        // Trigger Celebration
                        triggerStageCelebration();
                    }
                    isProcessing = false;
                    loadLevel();
                }
            }, 1000);
        }

        function showEndScreen(win) {
            document.querySelector('.game-container').querySelector('#playArea').style.display = 'none';
            const endScreen = document.getElementById('endScreen');
            endScreen.style.display = 'block';
            endScreen.querySelector('#endTitle').textContent = win ? "Grattis! ğŸ‘‘" : "Game Over ğŸ’€";
            endScreen.querySelector('#endMessage').textContent = win ? "Du har bemÃ¤strat alla nivÃ¥er!" : "Dina liv tog slut.";
            endScreen.querySelector('#finalScore').textContent = `PoÃ¤ng: ${score}`;
        }

        // ==========================================
        // UI FEATURES
        // ==========================================
        function toggleStageMap() {
            const el = document.getElementById('stageMapOverlay');
            if (el.style.display === 'block') {
                el.style.display = 'none';
            } else {
                renderStageMap();
                el.style.display = 'block';
            }
        }

        function renderStageMap() {
            const grid = document.getElementById('stageGrid');
            grid.innerHTML = '';
            for (let i = 1; i <= TOTAL_STAGES; i++) {
                const node = document.createElement('div');
                node.className = 'stage-node';
                node.textContent = i;

                if (i < currentStage) {
                    node.classList.add('solved');
                    node.innerHTML += ' âœ“';
                    // Allow clicking to replay solved stages
                    node.addEventListener('click', () => {
                        currentStage = i;
                        currentLevel = 1;
                        toggleStageMap();
                        loadLevel();
                    });
                } else if (i === currentStage) {
                    node.classList.add('current');
                    node.addEventListener('click', () => {
                        toggleStageMap(); // Just close and continue
                    });
                } else {
                    node.classList.add('locked');
                    node.innerHTML += ' ğŸ”’';
                }
                grid.appendChild(node);
            }
        }

        function triggerStageCelebration() {
            const overlay = document.getElementById('celebrationOverlay');
            overlay.innerHTML = '';
            overlay.style.display = 'block';

            // Create Confetti
            for (let i = 0; i < 100; i++) {
                const c = document.createElement('div');
                c.className = 'confetti';
                c.style.left = Math.random() * 100 + '%';
                c.style.backgroundColor = ['#f00', '#0f0', '#00f', '#ff0', '#f0f', '#0ff'][Math.floor(Math.random() * 6)];
                c.style.animationDuration = (Math.random() * 2 + 1) + 's';
                c.style.animationDelay = Math.random() + 's';
                overlay.appendChild(c);
            }

            // Big Text
            const text = document.createElement('h1');
            text.textContent = "STAGE CLEAR! ğŸ‰";
            text.style.position = 'absolute';
            text.style.top = '15%'; text.style.left = '50%'; /* Higher up */
            text.style.transform = 'translate(-50%, -50%) scale(0)';
            text.style.color = '#fff';
            text.style.fontSize = '3rem';
            text.style.textShadow = '0 0 20px black';
            text.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            overlay.appendChild(text);

            setTimeout(() => text.style.transform = 'translate(-50%, -50%) scale(1)', 100);

            // Cleanup
            setTimeout(() => {
                overlay.style.display = 'none';
                overlay.innerHTML = '';
            }, 3500);
        }

        // ==========================================
        // DAILY CHALLENGE SYSTEM
        // ==========================================
        let isDailyMode = false;
        let dailyStartTime = 0;
        let dailyTimerInterval = null;
        let dailyWordsCompleted = 0;
        const DAILY_WORDS_COUNT = 5;

        function getTodayKey() {
            const d = new Date();
            return `daily_${d.getFullYear()}_${d.getMonth()}_${d.getDate()}`;
        }

        function isDailyChallengeCompleted() {
            return localStorage.getItem(getTodayKey()) === 'completed';
        }

        function getDailyPairs() {
            // Generate consistent pairs for each day using date as seed
            const today = new Date();
            const seed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
            const shuffled = [...minimalPairsData].sort((a, b) => {
                const hashA = (seed * minimalPairsData.indexOf(a)) % 1000;
                const hashB = (seed * minimalPairsData.indexOf(b)) % 1000;
                return hashA - hashB;
            });
            return shuffled.slice(0, DAILY_WORDS_COUNT);
        }

        function updateDailyButton() {
            const btn = document.getElementById('dailyBtn');
            if (isDailyChallengeCompleted()) {
                btn.classList.add('completed');
                btn.innerHTML = 'âœ… Avklarad idag!';
            }
        }

        function startDailyChallenge() {
            if (isDailyChallengeCompleted()) return;

            isDailyMode = true;
            dailyWordsCompleted = 0;
            dailyStartTime = Date.now();

            // Hide start screen, show game
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('playArea').style.display = 'block';
            hasStarted = true;

            // Show timer
            const timerEl = document.getElementById('dailyTimer');
            timerEl.style.display = 'block';

            // Start timer update
            dailyTimerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - dailyStartTime) / 1000);
                const mins = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const secs = (elapsed % 60).toString().padStart(2, '0');
                timerEl.textContent = `â±ï¸ ${mins}:${secs}`;
            }, 1000);

            // Set up daily pairs
            window.dailyPairs = getDailyPairs();
            window.dailyIndex = 0;

            // Reset state
            lives = 3;
            streak = 0;
            score = 0;
            updateLives();

            loadDailyLevel();
        }

        function loadDailyLevel() {
            if (window.dailyIndex >= DAILY_WORDS_COUNT) {
                completeDailyChallenge();
                return;
            }

            currentPair = window.dailyPairs[window.dailyIndex];
            solvedStatus = { 1: false, 2: false };
            failedStatus = { 1: false, 2: false };
            currentTarget = 1;
            levelStartTime = Date.now();

            // Update UI
            levelBadge.textContent = `Daily: ${window.dailyIndex + 1}/${DAILY_WORDS_COUNT}`;

            cardFlipper.classList.remove('flipped');
            speedBadge.classList.remove('visible');

            const p = currentPair;
            let frame1 = p.w1.replace(new RegExp(p.pair[0], 'i'), '<span class="missing-vowel"></span>');
            let frame2 = p.w2.replace(new RegExp(p.pair[1], 'i'), '<span class="missing-vowel"></span>');

            document.querySelector('.word-1-text').innerHTML = frame1;
            document.querySelector('.word-2-text').innerHTML = frame2;
            document.querySelector('.word-1-def').innerText = p.d1;
            document.querySelector('.word-2-def').innerText = p.d2;
            document.getElementById('emoji1').textContent = p.e1 || 'ğŸ“¦';
            document.getElementById('emoji2').textContent = p.e2 || 'ğŸ“¦';

            updateTargetStyling();

            // All Swedish vowels for distractors
            const allVowels = ['A', 'E', 'I', 'O', 'U', 'Y', 'Ã…', 'Ã„', 'Ã–'];
            const correctVowels = p.pair;

            // Get 2 distractor vowels (not in the pair)
            const distractors = shuffleArray(allVowels
                .filter(v => !correctVowels.includes(v)))
                .slice(0, 2);

            // Combine and shuffle all 4 options
            const allOptions = shuffleArray([...correctVowels, ...distractors]);

            optionsArea.innerHTML = '';
            allOptions.forEach(v => {
                const btn = document.createElement('button');
                btn.className = 'vowel-btn slide-in';
                btn.textContent = v;
                btn.draggable = true;
                setupInteractions(btn, v);
                optionsArea.appendChild(btn);
            });
        }

        function dailyLevelComplete() {
            window.dailyIndex++;
            dailyWordsCompleted++;

            setTimeout(() => {
                cardFlipper.classList.add('flipped');
            }, 600);

            setTimeout(() => {
                loadDailyLevel();
            }, 1500);
        }

        function completeDailyChallenge() {
            // Stop timer
            clearInterval(dailyTimerInterval);
            document.getElementById('dailyTimer').style.display = 'none';

            // Mark as completed
            localStorage.setItem(getTodayKey(), 'completed');

            // Award +3 hearts
            lives = Math.min(lives + 3, 5);
            updateLives();

            // Show badge
            const badge = document.getElementById('dailyBadge');
            badge.classList.add('visible');

            // Calculate time
            const elapsed = Math.floor((Date.now() - dailyStartTime) / 1000);
            const mins = Math.floor(elapsed / 60);
            const secs = elapsed % 60;
            badge.innerHTML = `ğŸ† Dagens Utmaning Avklarad!<br><span style="font-size:1.2rem;">Tid: ${mins}:${secs.toString().padStart(2, '0')}</span><br><span style="font-size:2rem;">+3 â¤ï¸</span>`;

            setTimeout(() => {
                badge.classList.remove('visible');
                isDailyMode = false;
                // Return to start screen
                document.getElementById('playArea').style.display = 'none';
                document.getElementById('startScreen').style.display = 'flex';
                updateDailyButton();
            }, 4000);
        }

        // Override levelComplete for daily mode
        const originalLevelComplete = levelComplete;
        levelComplete = function () {
            if (isDailyMode) {
                dailyLevelComplete();
            } else {
                originalLevelComplete();
            }
        };

        // Check daily button on load
        document.addEventListener('DOMContentLoaded', updateDailyButton);

        // ==========================================
        // AUDIO LEARNING MODE
        // ==========================================
        let isAudioMode = false;

        function startAudioMode() {
            isAudioMode = true;

            // Add audio mode class to body
            document.body.classList.add('audio-mode');

            // Start normal game with audio mode active
            startGame();

            // Auto-play first word after a short delay
            setTimeout(() => {
                playAudioForSlot(currentTarget);
            }, 1000);
        }

        function revealWordInAudioMode(slotId) {
            if (!isAudioMode) return;
            const wordText = document.querySelector(`.word-${slotId}-text`);
            if (wordText) wordText.classList.add('revealed');
        }

        // Modify handleAnswer to reveal word in audio mode
        const originalHandleAnswer = handleAnswer;
        handleAnswer = function (selectedVowel, btnEl, slotId) {
            // Reveal the word when answered (correct or wrong)
            revealWordInAudioMode(slotId);

            // Call original
            originalHandleAnswer(selectedVowel, btnEl, slotId);
        };

        // Reset audio mode on game restart
        function resetAudioMode() {
            isAudioMode = false;
            document.body.classList.remove('audio-mode');
            document.querySelectorAll('.word-text').forEach(el => el.classList.remove('revealed'));
        }

        // Do NOT auto init; wait for Start Button
    </script>
</body>

</html>